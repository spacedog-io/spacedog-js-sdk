(function (global, factory) {
     typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :
     typeof define === 'function' && define.amd ? define(factory) :
     (global.SpaceDog = factory());
}(this, (function () { 'use strict';

var Config = {

    backendId: null,

    default_authorization_header: null

};

var qs = require('qs');

var UrlBuilder = {
    forLogin: function forLogin() {
        return Config.baseUrl + '/1/login';
    },
    forSchema: function forSchema() {
        return Config.baseUrl + '/1/schema';
    },
    forOneSchema: function forOneSchema(type) {
        return Config.baseUrl + '/1/schema/' + type;
    },
    forSearch: function forSearch(type) {
        return Config.baseUrl + '/1/search/' + type;
    },
    forCredentials: function forCredentials() {
        return Config.baseUrl + '/1/credentials';
    },
    forCredentialPassword: function forCredentialPassword(id) {
        return Config.baseUrl + '/1/credentials/' + id + '/password';
    },
    forCredentialForgotPassword: function forCredentialForgotPassword() {
        return Config.baseUrl + '/1/credentials/forgotPassword';
    },
    forCredentialResetPassword: function forCredentialResetPassword(credential_id, password_reset_code) {
        return Config.baseUrl + '/1/credentials/' + credential_id + '/password?passwordResetCode=' + password_reset_code;
    },
    forCredentialEnabled: function forCredentialEnabled(credential_id) {
        return Config.baseUrl + '/1/credentials/' + credential_id + '/enabled';
    },
    forCredentialData: function forCredentialData(credential_id) {
        return Config.baseUrl + '/1/credentials/' + credential_id;
    },
    forData: function forData(type) {
        return Config.baseUrl + '/1/data/' + type;
    },
    forDataObject: function forDataObject(type, id, opts) {
        var url = Config.baseUrl + '/1/data/' + type + '/' + id;
        if (opts) {
            return url + '?' + qs.stringify(opts);
        }
        return url;
    }
};

var _xend = function _xend(method, payload, url, cb, opts) {

    var data = null;
    if (payload !== undefined || payload !== null) {
        data = JSON.stringify(payload);
    }

    var xhr = new XMLHttpRequest();

    xhr.onreadystatechange = function () {
        if (xhr.readyState === 4) {
            try {
                var json = JSON.parse(xhr.responseText);

                // console.log("-----\nSpaceDog.Xhr# (",xhr.url,") SUCCESS, json is : ", json, "\n------\n")

                if (json !== null && (json.success === false || !(xhr.status >= 200 && xhr.status < 300))) {
                    cb(json, null);
                } else {
                    cb(null, json);
                }
            } catch (e) {
                console.warn("-----\nSpaceDog.Xhr# could not parse xhr.responseText (=", xhr.responseText, ") \n\n (xhr.url=", xhr.url, ") \n\n (xhr.method=", xhr.method, ") \n\n (xhr=", xhr, ") and therefore not able to 1/ set authorization headers 2/ remember user token, if rememberMe is true\n\nPossibly something else. Check the caught exeption:\n\n", e, "\n\n-------\n");
                cb(xhr.responseText, null);
            }
        }
    };

    xhr.open(method, url);
    xhr.setRequestHeader("content-type", "application/json;charset=UTF-8");

    if (opts && opts.authorization) {
        xhr.setRequestHeader("authorization", opts.authorization);
    } else if (Config.default_authorization_header !== null) {
        xhr.setRequestHeader("authorization", Config.default_authorization_header);
    }

    if (data === null) {
        xhr.send();
    } else {
        xhr.send(data);
    }
};

var UtilXHR = {
    get: function get(url, cb) {
        _xend("GET", null, url, cb);
    },
    post: function post(payload, url, cb) {
        _xend("POST", payload, url, cb);
    },
    put: function put(payload, url, cb, opts) {
        _xend("PUT", payload, url, cb, opts);
    },
    delete: function _delete(url, cb) {
        _xend("DELETE", null, url, cb);
    }
};

var Credentials = {
    canTryLogin: function canTryLogin() {
        return localStorage.getItem('SPACEDOG_CREDENTIALS_TOKEN') !== undefined && localStorage.getItem('SPACEDOG_CREDENTIALS_TOKEN') !== null;
    },
    createUser: function createUser(opts, cb) {

        UtilXHR.post({
            username: opts.credentials.username,
            password: opts.credentials.password,
            email: opts.credentials.email
        }, UrlBuilder.forCredentials(), function (err, data) {

            if (err === null) {

                var userPayload = opts.user.payload;

                userPayload[opts.user.credentialIdField] = data.id;

                UtilXHR.post(opts.user.payload, UrlBuilder.forData(opts.user.type), function (err, data) {
                    if (err === null) {

                        userPayload.username = opts.credentials.username;
                        userPayload.email = opts.credentials.email;
                        userPayload.meta = {
                            id: data.id
                        };

                        cb(null, userPayload);
                    } else {
                        cb(err, null);
                    }
                });
            } else {

                cb(err, null);
            }
        });
    },
    forget: function forget() {
        Config.default_authorization_header = null;
        localStorage.removeItem('SPACEDOG_CREDENTIALS_TOKEN');
    },
    forgotPassword: function forgotPassword(opts, cb) {
        UtilXHR.post(opts, UrlBuilder.forCredentialForgotPassword(), function (err, data) {
            if (err === null) {
                cb(null, data);
            } else {
                cb(err, null);
            }
        });
    },
    getEnabledState: function getEnabledState(opts, cb) {
        UtilXHR.get(UrlBuilder.forCredentialData(opts.credentialId), function (err, data) {
            if (err === null) {
                cb(null, data.enabled);
            } else {
                cb(err, null);
            }
        });
    },
    getRememberedState: function getRememberedState() {
        return JSON.parse(localStorage.getItem('SPACEDOG_CREDENTIALS_TOKEN'));
    },


    /**
     * opts : { username:string, password:string, rememberMe:bool }
     * cb : callback function
     */
    login: function login(opts, cb) {

        try {
            Config.default_authorization_header = "Basic " + new Buffer(opts.username + ":" + opts.password).toString('base64');
        } catch (e) {
            Config.default_authorization_header = "Basic " + btoa(opts.username + ":" + opts.password);
        }

        UtilXHR.get(UrlBuilder.forLogin(), function (err, data) {

            if (err !== null) {

                Config.default_authorization_header = null;
            } else {

                Config.default_authorization_header = "Bearer " + data.accessToken;

                if (opts.rememberMe) {

                    localStorage.setItem('SPACEDOG_CREDENTIALS_TOKEN', JSON.stringify({
                        "accessToken": data.accessToken,
                        "backendId": Config.backendId,
                        "baseUrl": Config.baseUrl
                    }));
                }
            }

            cb(err, data);
        });
    },
    loginWithSavedCredentials: function loginWithSavedCredentials(cb) {

        var saved = JSON.parse(localStorage.getItem('SPACEDOG_CREDENTIALS_TOKEN'));

        Config.backendId = saved.backendId;
        Config.baseUrl = saved.baseUrl;
        Config.default_authorization_header = "Bearer " + saved.accessToken;

        UtilXHR.get(UrlBuilder.forLogin(), function (err, data) {

            if (err === null) {
                if (data && data.accessToken) {
                    Config.default_authorization_header = "Bearer " + data.accessToken;
                }
            }

            cb(err, data);
        });
    },
    resetPassword: function resetPassword(opts, cb) {
        UtilXHR.post({ password: opts.password }, UrlBuilder.forCredentialResetPassword(opts.credentialId, opts.passwordResetCode), function (err, data) {
            if (err === null) {
                cb(null, data);
            } else {
                cb(err, null);
            }
        });
    },
    setEnabledState: function setEnabledState(opts, cb) {
        UtilXHR.put(opts.state, UrlBuilder.forCredentialEnabled(opts.credentialId), function (err, data) {
            if (err === null) {
                cb(null, data);
            } else {
                cb(err, null);
            }
        });
    },
    updatePassword: function updatePassword(opts, cb) {

        UtilXHR.put(opts.newPassword, UrlBuilder.forCredentialPassword(opts.credentialId), function (err, data) {
            if (err === null) {
                cb(null, data);
            } else {
                cb(err, null);
            }
        }, {
            'authorization': 'Basic ' + btoa(opts.challengedUsername + ":" + opts.challengedPassword)
        });
    }
};

var classCallCheck = function (instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
};

var createClass = function () {
  function defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  return function (Constructor, protoProps, staticProps) {
    if (protoProps) defineProperties(Constructor.prototype, protoProps);
    if (staticProps) defineProperties(Constructor, staticProps);
    return Constructor;
  };
}();

var PaginationSession = function () {
    function PaginationSession(from, size) {
        classCallCheck(this, PaginationSession);

        this._from = from;
        this._size = size;
        this._total = null;
    }

    createClass(PaginationSession, [{
        key: "isNextPageAvailable",
        value: function isNextPageAvailable() {
            if (this._total == null) {
                return true;
            }
            return this._from + this._size < this._total;
        }
    }, {
        key: "isPrevPageAvailable",
        value: function isPrevPageAvailable() {
            if (this._total == null) {
                return false;
            }
            return this._from >= this._size;
        }
    }, {
        key: "_newPageLoaded",
        value: function _newPageLoaded(result) {
            this._total = result.total;
        }
    }, {
        key: "pointNextPage",
        value: function pointNextPage() {
            this._from += this._size;
        }
    }, {
        key: "pointPrevPage",
        value: function pointPrevPage() {
            this._from -= this._size;
        }
    }, {
        key: "getFrom",
        value: function getFrom() {
            return this._from;
        }
    }, {
        key: "getSize",
        value: function getSize() {
            return this._size;
        }
    }]);
    return PaginationSession;
}();

var Object$1 = function () {
  function Object(type, id, payload) {
    classCallCheck(this, Object);

    this._type = type;
    this._id = id;
    this._payload = payload;
  }

  createClass(Object, [{
    key: 'create',
    value: function create(cb) {
      var ret = this._payload;
      UtilXHR.post(this._payload, UrlBuilder.forData(this._type), function (err, data) {

        if (data) {
          ret.meta = {
            id: data.id
          };
        }

        cb(err, ret);
      });
    }
  }, {
    key: 'update',
    value: function update(cb, opts) {
      UtilXHR.put(this._payload, UrlBuilder.forDataObject(this._type, this._id, opts), cb);
    }
  }, {
    key: 'delete',
    value: function _delete(cb) {
      UtilXHR.delete(UrlBuilder.forDataObject(this._type, this._id), cb);
    }
  }, {
    key: 'get',
    value: function get$$1(cb) {
      UtilXHR.get(UrlBuilder.forDataObject(this._type, this._id), cb);
    }
  }]);
  return Object;
}();

var Data = {

    PaginationSession: PaginationSession,

    buildObject: function buildObject(type, id, payload) {
        return new Object$1(type, id, payload);
    },


    /**
     * opts : { type:string }
     * cb : callback function
     * paginationSession : optional paginationSession
     */
    search: function search(opts, cb, paginationSession) {

        if (opts.payload == undefined) {
            opts.payload = {};
        }

        if (paginationSession) {

            opts.payload.from = paginationSession.getFrom(), opts.payload.size = paginationSession.getSize();
        }

        UtilXHR.post(opts.payload, UrlBuilder.forSearch(opts.type), function (err, data) {
            if (err != null) {
                cb(err, data);
            } else {

                if (paginationSession) paginationSession._newPageLoaded(data);

                cb(err, data);
            }
        });
    }
};

var Schema = {

  /**
   * cb : callback function
   */
  list: function list(cb) {

    UtilXHR.get(UrlBuilder.forSchema(), cb);
  },


  /**
   * type : string, the name of the schema
   * schemaDef : content for the new schema : _acl and other elastic search attributes
   * cb : callback function
   */
  create: function create(type, schemaDef, cb) {

    var payload = {};
    payload[type] = schemaDef;

    UtilXHR.post(payload, UrlBuilder.forOneSchema(type), cb);
  }
};

var DataPermission = {

     all: ['create', 'read', 'read_all', 'search', 'update', 'update_all', 'delete', 'delete_all'],

     default_admin: ['create', 'search', 'update_all', 'delete_all'],

     default_user: ['create', 'search', 'update', 'delete'],

     default_key: ['read_all']

};

var DataTypes = [{
  name: 'string'
}, {
  name: 'boolean'
}];

var SpaceDog = {
    initialize: function initialize(backendId) {
        if (backendId == undefined) {
            throw "BackendId is required.";
        }
        Config.backendId = backendId;
        Config.baseUrl = 'https://' + Config.backendId + '.spacedog.io';
    },
    initializeWithBaseUrl: function initializeWithBaseUrl(baseUrl) {
        if (baseUrl == undefined) {
            throw "BaseUrl is required.";
        }
        Config.backendId = null;
        Config.baseUrl = baseUrl;
    },
    getBaseUrl: function getBaseUrl() {
        return Config.baseUrl;
    },
    getBackendId: function getBackendId() {
        return Config.backendId;
    },
    forgetAll: function forgetAll() {
        Config.backendId = null;
        Config.baseUrl = null;
        Config.default_authorization_header = null;
    }
};

SpaceDog._Config = Config; // pas en release ?
SpaceDog.Credentials = Credentials;
SpaceDog.Data = Data;
SpaceDog.Schema = Schema;
SpaceDog.DataPermission = DataPermission;
SpaceDog.DataTypes = DataTypes;

return SpaceDog;

})));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjpudWxsLCJzb3VyY2VzIjpbInNyYy9saWIvY29uZmlnLmpzIiwic3JjL2xpYi91cmxCdWlsZGVyLmpzIiwic3JjL2xpYi91dGlsWGhyLmpzIiwic3JjL2xpYi9jcmVkZW50aWFscy5qcyIsInNyYy9saWIvcGFnaW5hdGlvblNlc3Npb24uanMiLCJzcmMvbGliL29iamVjdC5qcyIsInNyYy9saWIvZGF0YS5qcyIsInNyYy9saWIvc2NoZW1hLmpzIiwic3JjL2xpYi9kYXRhUGVybWlzc2lvbi5qcyIsInNyYy9saWIvZGF0YVR5cGVzLmpzIiwic3JjL3NwYWNlZG9nLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IHtcblxuICAgIGJhY2tlbmRJZDpudWxsLFxuXG4gICAgZGVmYXVsdF9hdXRob3JpemF0aW9uX2hlYWRlcjpudWxsXG5cbn0iLCJpbXBvcnQgQ29uZmlnIGZyb20gJy4vY29uZmlnLmpzJ1xuaW1wb3J0IGNyZWRlbnRpYWxzIGZyb20gXCIuL2NyZWRlbnRpYWxzXCI7XG52YXIgcXMgPSByZXF1aXJlKCdxcycpO1xuXG5leHBvcnQgZGVmYXVsdCB7XG5cbiAgICBmb3JMb2dpbiAoKSB7XG4gICAgICAgIHJldHVybiBgJHtDb25maWcuYmFzZVVybH0vMS9sb2dpbmBcbiAgICB9LFxuXG4gICAgZm9yU2NoZW1hICgpIHtcbiAgICAgICAgcmV0dXJuIGAke0NvbmZpZy5iYXNlVXJsfS8xL3NjaGVtYWAgIFxuICAgIH0sXG5cbiAgICBmb3JPbmVTY2hlbWEgKHR5cGUpIHtcbiAgICAgICAgcmV0dXJuIGAke0NvbmZpZy5iYXNlVXJsfS8xL3NjaGVtYS8ke3R5cGV9YCAgXG4gICAgfSxcblxuICAgIGZvclNlYXJjaCAodHlwZSkge1xuICAgICAgICByZXR1cm4gYCR7Q29uZmlnLmJhc2VVcmx9LzEvc2VhcmNoLyR7dHlwZX1gXG4gICAgfSxcblxuICAgIGZvckNyZWRlbnRpYWxzICgpIHtcbiAgICAgICAgcmV0dXJuIGAke0NvbmZpZy5iYXNlVXJsfS8xL2NyZWRlbnRpYWxzYFxuICAgIH0sXG5cbiAgICBmb3JDcmVkZW50aWFsUGFzc3dvcmQgKGlkKSB7XG4gICAgICAgIHJldHVybiBgJHtDb25maWcuYmFzZVVybH0vMS9jcmVkZW50aWFscy8ke2lkfS9wYXNzd29yZGBcbiAgICB9LFxuXG4gICAgZm9yQ3JlZGVudGlhbEZvcmdvdFBhc3N3b3JkICgpIHtcbiAgICAgICAgcmV0dXJuIGAke0NvbmZpZy5iYXNlVXJsfS8xL2NyZWRlbnRpYWxzL2ZvcmdvdFBhc3N3b3JkYFxuICAgIH0sXG5cbiAgICBmb3JDcmVkZW50aWFsUmVzZXRQYXNzd29yZCAoY3JlZGVudGlhbF9pZCwgcGFzc3dvcmRfcmVzZXRfY29kZSkge1xuICAgICAgICByZXR1cm4gYCR7Q29uZmlnLmJhc2VVcmx9LzEvY3JlZGVudGlhbHMvJHtjcmVkZW50aWFsX2lkfS9wYXNzd29yZD9wYXNzd29yZFJlc2V0Q29kZT0ke3Bhc3N3b3JkX3Jlc2V0X2NvZGV9YFxuICAgIH0sXG5cbiAgICBmb3JDcmVkZW50aWFsRW5hYmxlZCAoY3JlZGVudGlhbF9pZCkge1xuICAgICAgICByZXR1cm4gYCR7Q29uZmlnLmJhc2VVcmx9LzEvY3JlZGVudGlhbHMvJHtjcmVkZW50aWFsX2lkfS9lbmFibGVkYFxuICAgIH0sXG5cbiAgICBmb3JDcmVkZW50aWFsRGF0YSAoY3JlZGVudGlhbF9pZCkge1xuICAgICAgICByZXR1cm4gYCR7Q29uZmlnLmJhc2VVcmx9LzEvY3JlZGVudGlhbHMvJHtjcmVkZW50aWFsX2lkfWBcbiAgICB9LFxuXG4gICAgZm9yRGF0YSAodHlwZSkge1xuICAgICAgICByZXR1cm4gYCR7Q29uZmlnLmJhc2VVcmx9LzEvZGF0YS8ke3R5cGV9YFxuICAgIH0sXG5cbiAgICBmb3JEYXRhT2JqZWN0ICh0eXBlLCBpZCwgb3B0cykge1xuICAgICAgICB2YXIgdXJsID0gYCR7Q29uZmlnLmJhc2VVcmx9LzEvZGF0YS8ke3R5cGV9LyR7aWR9YFxuICAgICAgICBpZiAob3B0cykge1xuICAgICAgICAgICAgcmV0dXJuIGAke3VybH0/JHtxcy5zdHJpbmdpZnkob3B0cyl9YFxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1cmxcbiAgICB9LFxufSIsImltcG9ydCBDb25maWcgZnJvbSAnLi9jb25maWcnXG5cbmxldCBfeGVuZCA9IGZ1bmN0aW9uKG1ldGhvZCwgcGF5bG9hZCwgdXJsLCBjYiwgb3B0cyl7XG5cbiAgICBsZXQgZGF0YSA9IG51bGw7XG4gICAgaWYgKHBheWxvYWQgIT09IHVuZGVmaW5lZCB8fCBwYXlsb2FkICE9PSBudWxsKSB7XG4gICAgICAgIGRhdGEgPSBKU09OLnN0cmluZ2lmeShwYXlsb2FkKTtcbiAgICB9XG5cbiAgICBsZXQgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSA0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsZXQganNvbiA9IEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCk7XG5cbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiLS0tLS1cXG5TcGFjZURvZy5YaHIjIChcIix4aHIudXJsLFwiKSBTVUNDRVNTLCBqc29uIGlzIDogXCIsIGpzb24sIFwiXFxuLS0tLS0tXFxuXCIpXG5cbiAgICAgICAgICAgIGlmIChqc29uICE9PSBudWxsICYmIChqc29uLnN1Y2Nlc3M9PT1mYWxzZSB8fCAhKHhoci5zdGF0dXMgPj0gMjAwICYmIHhoci5zdGF0dXMgPCAzMDAgKSkpIHtcbiAgICAgICAgICAgICAgICBjYihqc29uLCBudWxsKVxuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNiKG51bGwsIGpzb24pXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKFwiLS0tLS1cXG5TcGFjZURvZy5YaHIjIGNvdWxkIG5vdCBwYXJzZSB4aHIucmVzcG9uc2VUZXh0ICg9XCIseGhyLnJlc3BvbnNlVGV4dCxcIikgXFxuXFxuICh4aHIudXJsPVwiLHhoci51cmwsXCIpIFxcblxcbiAoeGhyLm1ldGhvZD1cIix4aHIubWV0aG9kLFwiKSBcXG5cXG4gKHhocj1cIix4aHIsXCIpIGFuZCB0aGVyZWZvcmUgbm90IGFibGUgdG8gMS8gc2V0IGF1dGhvcml6YXRpb24gaGVhZGVycyAyLyByZW1lbWJlciB1c2VyIHRva2VuLCBpZiByZW1lbWJlck1lIGlzIHRydWVcXG5cXG5Qb3NzaWJseSBzb21ldGhpbmcgZWxzZS4gQ2hlY2sgdGhlIGNhdWdodCBleGVwdGlvbjpcXG5cXG5cIiwgZSxcIlxcblxcbi0tLS0tLS1cXG5cIik7XG4gICAgICAgICAgICBjYih4aHIucmVzcG9uc2VUZXh0LCBudWxsKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIHhoci5vcGVuKG1ldGhvZCwgdXJsKTtcbiAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcImNvbnRlbnQtdHlwZVwiLCBcImFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD1VVEYtOFwiKTtcblxuICAgIGlmIChvcHRzICYmIG9wdHMuYXV0aG9yaXphdGlvbikge1xuICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcImF1dGhvcml6YXRpb25cIiwgb3B0cy5hdXRob3JpemF0aW9uKTtcbiAgICB9IGVsc2UgaWYgKENvbmZpZy5kZWZhdWx0X2F1dGhvcml6YXRpb25faGVhZGVyICE9PSBudWxsKSB7XG4gICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiYXV0aG9yaXphdGlvblwiLCBDb25maWcuZGVmYXVsdF9hdXRob3JpemF0aW9uX2hlYWRlcik7XG4gICAgfVxuXG4gICAgaWYgKGRhdGEgPT09IG51bGwpIHtcbiAgICAgICAgeGhyLnNlbmQoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB4aHIuc2VuZChkYXRhKTtcbiAgICB9XG5cbn07XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBnZXQgKHVybCwgY2IpIHtcbiAgICAgICAgX3hlbmQoXCJHRVRcIiwgbnVsbCwgdXJsLCBjYilcbiAgICB9LFxuXG4gICAgcG9zdCAocGF5bG9hZCwgdXJsLCBjYikge1xuICAgICAgICBfeGVuZChcIlBPU1RcIiwgcGF5bG9hZCwgdXJsLCBjYilcbiAgICB9LFxuXG4gICAgcHV0IChwYXlsb2FkLCB1cmwsIGNiLCBvcHRzKSB7XG4gICAgICAgIF94ZW5kKFwiUFVUXCIsIHBheWxvYWQsIHVybCwgY2IsIG9wdHMpXG4gICAgfSxcblxuICAgIGRlbGV0ZSAodXJsLCBjYikge1xuICAgICAgICBfeGVuZChcIkRFTEVURVwiLCBudWxsLCB1cmwsIGNiKVxuICAgIH0sXG59IiwiaW1wb3J0IFVybEJ1aWxkZXIgZnJvbSAnLi91cmxCdWlsZGVyLmpzJ1xuaW1wb3J0IENvbmZpZyBmcm9tICcuL2NvbmZpZy5qcydcbmltcG9ydCBVdGlsWEhSIGZyb20gJy4vdXRpbFhocidcblxuZXhwb3J0IGRlZmF1bHQge1xuXG4gICAgY2FuVHJ5TG9naW4oKSB7XG4gICAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnU1BBQ0VET0dfQ1JFREVOVElBTFNfVE9LRU4nKSAhPT0gdW5kZWZpbmVkICYmIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdTUEFDRURPR19DUkVERU5USUFMU19UT0tFTicpICE9PSBudWxsXG4gICAgfSxcblxuICAgIGNyZWF0ZVVzZXIob3B0cywgY2IpIHtcblxuICAgICAgICBVdGlsWEhSLnBvc3Qoe1xuICAgICAgICAgICAgICAgIHVzZXJuYW1lOiBvcHRzLmNyZWRlbnRpYWxzLnVzZXJuYW1lLFxuICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBvcHRzLmNyZWRlbnRpYWxzLnBhc3N3b3JkLFxuICAgICAgICAgICAgICAgIGVtYWlsOiBvcHRzLmNyZWRlbnRpYWxzLmVtYWlsLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFVybEJ1aWxkZXIuZm9yQ3JlZGVudGlhbHMoKSxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHtcblxuICAgICAgICAgICAgICAgIGlmIChlcnIgPT09IG51bGwpIHtcblxuICAgICAgICAgICAgICAgICAgICBsZXQgdXNlclBheWxvYWQgPSBvcHRzLnVzZXIucGF5bG9hZDtcblxuICAgICAgICAgICAgICAgICAgICB1c2VyUGF5bG9hZFtvcHRzLnVzZXIuY3JlZGVudGlhbElkRmllbGRdID0gZGF0YS5pZDtcblxuICAgICAgICAgICAgICAgICAgICBVdGlsWEhSLnBvc3Qob3B0cy51c2VyLnBheWxvYWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBVcmxCdWlsZGVyLmZvckRhdGEob3B0cy51c2VyLnR5cGUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGVyciwgZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIgPT09IG51bGwpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyUGF5bG9hZC51c2VybmFtZSA9IG9wdHMuY3JlZGVudGlhbHMudXNlcm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJQYXlsb2FkLmVtYWlsID0gb3B0cy5jcmVkZW50aWFscy5lbWFpbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlclBheWxvYWQubWV0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBkYXRhLmlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2IobnVsbCwgdXNlclBheWxvYWQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2IoZXJyLCBudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgY2IoZXJyLCBudWxsKTtcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgfSxcblxuICAgIGZvcmdldCgpIHtcbiAgICAgICAgQ29uZmlnLmRlZmF1bHRfYXV0aG9yaXphdGlvbl9oZWFkZXIgPSBudWxsO1xuICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnU1BBQ0VET0dfQ1JFREVOVElBTFNfVE9LRU4nKVxuICAgIH0sXG5cbiAgICBmb3Jnb3RQYXNzd29yZChvcHRzLCBjYikge1xuICAgICAgICBVdGlsWEhSLnBvc3Qob3B0cywgVXJsQnVpbGRlci5mb3JDcmVkZW50aWFsRm9yZ290UGFzc3dvcmQoKSwgZnVuY3Rpb24gKGVyciwgZGF0YSkge1xuICAgICAgICAgICAgaWYgKGVyciA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNiKG51bGwsIGRhdGEpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNiKGVyciwgbnVsbClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9LFxuXG4gICAgZ2V0RW5hYmxlZFN0YXRlKG9wdHMsIGNiKSB7XG4gICAgICAgIFV0aWxYSFIuZ2V0KFVybEJ1aWxkZXIuZm9yQ3JlZGVudGlhbERhdGEob3B0cy5jcmVkZW50aWFsSWQpLCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZXJyID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY2IobnVsbCwgZGF0YS5lbmFibGVkKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjYihlcnIsIG51bGwpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfSxcblxuICAgIGdldFJlbWVtYmVyZWRTdGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ1NQQUNFRE9HX0NSRURFTlRJQUxTX1RPS0VOJykpXG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIG9wdHMgOiB7IHVzZXJuYW1lOnN0cmluZywgcGFzc3dvcmQ6c3RyaW5nLCByZW1lbWJlck1lOmJvb2wgfVxuICAgICAqIGNiIDogY2FsbGJhY2sgZnVuY3Rpb25cbiAgICAgKi9cbiAgICBsb2dpbihvcHRzLCBjYikge1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBDb25maWcuZGVmYXVsdF9hdXRob3JpemF0aW9uX2hlYWRlciA9IFwiQmFzaWMgXCIgKyBuZXcgQnVmZmVyKG9wdHMudXNlcm5hbWUgKyBcIjpcIiArIG9wdHMucGFzc3dvcmQpLnRvU3RyaW5nKCdiYXNlNjQnKVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBDb25maWcuZGVmYXVsdF9hdXRob3JpemF0aW9uX2hlYWRlciA9IFwiQmFzaWMgXCIgKyBidG9hKG9wdHMudXNlcm5hbWUgKyBcIjpcIiArIG9wdHMucGFzc3dvcmQpXG4gICAgICAgIH1cblxuICAgICAgICBVdGlsWEhSLmdldChVcmxCdWlsZGVyLmZvckxvZ2luKCksIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHtcblxuICAgICAgICAgICAgaWYgKGVyciAhPT0gbnVsbCkge1xuXG4gICAgICAgICAgICAgICAgQ29uZmlnLmRlZmF1bHRfYXV0aG9yaXphdGlvbl9oZWFkZXIgPSBudWxsXG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICBDb25maWcuZGVmYXVsdF9hdXRob3JpemF0aW9uX2hlYWRlciA9IFwiQmVhcmVyIFwiICsgZGF0YS5hY2Nlc3NUb2tlbjtcblxuICAgICAgICAgICAgICAgIGlmIChvcHRzLnJlbWVtYmVyTWUpIHtcblxuICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnU1BBQ0VET0dfQ1JFREVOVElBTFNfVE9LRU4nLCBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImFjY2Vzc1Rva2VuXCI6IGRhdGEuYWNjZXNzVG9rZW4sXG4gICAgICAgICAgICAgICAgICAgICAgICBcImJhY2tlbmRJZFwiOiBDb25maWcuYmFja2VuZElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJiYXNlVXJsXCI6IENvbmZpZy5iYXNlVXJsXG4gICAgICAgICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYihlcnIsIGRhdGEpXG5cbiAgICAgICAgfSlcblxuICAgIH0sXG5cbiAgICBsb2dpbldpdGhTYXZlZENyZWRlbnRpYWxzKGNiKSB7XG5cbiAgICAgICAgbGV0IHNhdmVkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnU1BBQ0VET0dfQ1JFREVOVElBTFNfVE9LRU4nKSk7XG5cbiAgICAgICAgQ29uZmlnLmJhY2tlbmRJZCA9IHNhdmVkLmJhY2tlbmRJZDtcbiAgICAgICAgQ29uZmlnLmJhc2VVcmwgPSBzYXZlZC5iYXNlVXJsO1xuICAgICAgICBDb25maWcuZGVmYXVsdF9hdXRob3JpemF0aW9uX2hlYWRlciA9IFwiQmVhcmVyIFwiICsgc2F2ZWQuYWNjZXNzVG9rZW47XG5cbiAgICAgICAgVXRpbFhIUi5nZXQoVXJsQnVpbGRlci5mb3JMb2dpbigpLCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7XG5cbiAgICAgICAgICAgIGlmIChlcnIgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YSAmJiBkYXRhLmFjY2Vzc1Rva2VuKSB7XG4gICAgICAgICAgICAgICAgICAgIENvbmZpZy5kZWZhdWx0X2F1dGhvcml6YXRpb25faGVhZGVyID0gXCJCZWFyZXIgXCIgKyBkYXRhLmFjY2Vzc1Rva2VuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYihlcnIsIGRhdGEpXG5cbiAgICAgICAgfSlcblxuICAgIH0sXG5cbiAgICByZXNldFBhc3N3b3JkKG9wdHMsIGNiKSB7XG4gICAgICAgIFV0aWxYSFIucG9zdCh7cGFzc3dvcmQ6IG9wdHMucGFzc3dvcmR9LCBVcmxCdWlsZGVyLmZvckNyZWRlbnRpYWxSZXNldFBhc3N3b3JkKG9wdHMuY3JlZGVudGlhbElkLCBvcHRzLnBhc3N3b3JkUmVzZXRDb2RlKSwgZnVuY3Rpb24gKGVyciwgZGF0YSkge1xuICAgICAgICAgICAgaWYgKGVyciA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNiKG51bGwsIGRhdGEpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNiKGVyciwgbnVsbClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9LFxuXG4gICAgc2V0RW5hYmxlZFN0YXRlKG9wdHMsIGNiKSB7XG4gICAgICAgIFV0aWxYSFIucHV0KG9wdHMuc3RhdGUsIFVybEJ1aWxkZXIuZm9yQ3JlZGVudGlhbEVuYWJsZWQob3B0cy5jcmVkZW50aWFsSWQpLCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZXJyID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY2IobnVsbCwgZGF0YSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2IoZXJyLCBudWxsKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH0sXG5cbiAgICB1cGRhdGVQYXNzd29yZChvcHRzLCBjYikge1xuXG5cbiAgICAgICAgVXRpbFhIUi5wdXQob3B0cy5uZXdQYXNzd29yZCwgVXJsQnVpbGRlci5mb3JDcmVkZW50aWFsUGFzc3dvcmQob3B0cy5jcmVkZW50aWFsSWQpLCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZXJyID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY2IobnVsbCwgZGF0YSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2IoZXJyLCBudWxsKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgICdhdXRob3JpemF0aW9uJzogJ0Jhc2ljICcgKyBidG9hKG9wdHMuY2hhbGxlbmdlZFVzZXJuYW1lICsgXCI6XCIgKyBvcHRzLmNoYWxsZW5nZWRQYXNzd29yZClcbiAgICAgICAgfSlcblxuICAgIH0sXG59IiwiXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQYWdpbmF0aW9uU2Vzc2lvbiB7XG5cbiAgICBjb25zdHJ1Y3RvciAoZnJvbSwgc2l6ZSkge1xuICAgICAgICB0aGlzLl9mcm9tID0gZnJvbVxuICAgICAgICB0aGlzLl9zaXplID0gc2l6ZVxuICAgICAgICB0aGlzLl90b3RhbCA9IG51bGxcbiAgICB9XG5cbiAgICBpc05leHRQYWdlQXZhaWxhYmxlICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3RvdGFsID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2Zyb20gKyB0aGlzLl9zaXplIDwgdGhpcy5fdG90YWxcbiAgICB9XG5cblxuICAgIGlzUHJldlBhZ2VBdmFpbGFibGUgKCkge1xuICAgICAgICBpZiAodGhpcy5fdG90YWwgPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2Zyb20gPj0gdGhpcy5fc2l6ZVxuICAgIH1cblxuICAgIF9uZXdQYWdlTG9hZGVkIChyZXN1bHQpIHtcbiAgICAgICAgdGhpcy5fdG90YWwgPSByZXN1bHQudG90YWxcbiAgICB9XG5cbiAgICBwb2ludE5leHRQYWdlICgpIHtcbiAgICAgICAgdGhpcy5fZnJvbSArPSB0aGlzLl9zaXplXG4gICAgfVxuXG4gICAgcG9pbnRQcmV2UGFnZSAoKSB7XG4gICAgICAgIHRoaXMuX2Zyb20gLT0gdGhpcy5fc2l6ZVxuICAgIH1cblxuICAgIGdldEZyb20gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZnJvbVxuICAgIH1cblxuICAgIGdldFNpemUgKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2l6ZVxuICAgIH1cblxufSIsImltcG9ydCBVcmxCdWlsZGVyIGZyb20gJy4vdXJsQnVpbGRlcidcbmltcG9ydCBVdGlsWEhSIGZyb20gJy4vdXRpbFhocidcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgT2JqZWN0IHtcblxuICBjb25zdHJ1Y3RvciAodHlwZSwgaWQsIHBheWxvYWQpIHtcbiAgICB0aGlzLl90eXBlID0gdHlwZVxuICAgIHRoaXMuX2lkID0gaWRcbiAgICB0aGlzLl9wYXlsb2FkID0gcGF5bG9hZFxuICB9XG5cbiAgY3JlYXRlIChjYikge1xuICAgIHZhciByZXQgPSB0aGlzLl9wYXlsb2FkO1xuICAgIFV0aWxYSFIucG9zdCh0aGlzLl9wYXlsb2FkLCBVcmxCdWlsZGVyLmZvckRhdGEodGhpcy5fdHlwZSksIGZ1bmN0aW9uKGVyciwgZGF0YSl7XG5cbiAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgIHJldC5tZXRhID0ge1xuICAgICAgICAgIGlkOiBkYXRhLmlkXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY2IoZXJyLCByZXQpXG4gICAgfSk7XG4gIH1cblxuICB1cGRhdGUgKGNiLCBvcHRzKSB7XG4gICAgVXRpbFhIUi5wdXQodGhpcy5fcGF5bG9hZCwgVXJsQnVpbGRlci5mb3JEYXRhT2JqZWN0KHRoaXMuX3R5cGUsIHRoaXMuX2lkLCBvcHRzKSwgY2IpXG4gIH1cblxuICBkZWxldGUgKGNiKSB7XG4gICAgVXRpbFhIUi5kZWxldGUoVXJsQnVpbGRlci5mb3JEYXRhT2JqZWN0KHRoaXMuX3R5cGUsIHRoaXMuX2lkKSwgY2IpXG4gIH1cblxuICBnZXQgKGNiKSB7XG4gICAgVXRpbFhIUi5nZXQoVXJsQnVpbGRlci5mb3JEYXRhT2JqZWN0KHRoaXMuX3R5cGUsIHRoaXMuX2lkKSwgY2IpXG4gIH1cblxufSIsImltcG9ydCBVcmxCdWlsZGVyIGZyb20gJy4vdXJsQnVpbGRlcidcbmltcG9ydCBVdGlsWEhSIGZyb20gJy4vdXRpbFhocidcbmltcG9ydCBQYWdpbmF0aW9uU2Vzc2lvbiBmcm9tICcuL3BhZ2luYXRpb25TZXNzaW9uJ1xuaW1wb3J0IE9iamVjdCBmcm9tICcuL29iamVjdCdcblxudmFyIERhdGEgPSB7XG4gICAgIFxuICAgIFBhZ2luYXRpb25TZXNzaW9uLFxuXG4gICAgYnVpbGRPYmplY3QgKHR5cGUsIGlkLCBwYXlsb2FkKSB7XG4gICAgICByZXR1cm4gbmV3IE9iamVjdCAodHlwZSwgaWQsIHBheWxvYWQpXG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIG9wdHMgOiB7IHR5cGU6c3RyaW5nIH1cbiAgICAgKiBjYiA6IGNhbGxiYWNrIGZ1bmN0aW9uXG4gICAgICogcGFnaW5hdGlvblNlc3Npb24gOiBvcHRpb25hbCBwYWdpbmF0aW9uU2Vzc2lvblxuICAgICAqL1xuICAgIHNlYXJjaCAob3B0cywgY2IsIHBhZ2luYXRpb25TZXNzaW9uKSB7XG5cbiAgICAgICAgaWYgKG9wdHMucGF5bG9hZCA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG9wdHMucGF5bG9hZCA9IHt9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocGFnaW5hdGlvblNlc3Npb24pIHtcblxuICAgICAgICAgICAgb3B0cy5wYXlsb2FkLmZyb20gPSBwYWdpbmF0aW9uU2Vzc2lvbi5nZXRGcm9tKCksXG4gICAgICAgICAgICBvcHRzLnBheWxvYWQuc2l6ZSA9IHBhZ2luYXRpb25TZXNzaW9uLmdldFNpemUoKVxuXG4gICAgICAgIH1cblxuICAgICAgICBVdGlsWEhSLnBvc3Qob3B0cy5wYXlsb2FkLCBVcmxCdWlsZGVyLmZvclNlYXJjaChvcHRzLnR5cGUpLCBmdW5jdGlvbihlcnIsIGRhdGEpe1xuICAgICAgICAgICAgaWYgKGVyciAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY2IoZXJyLCBkYXRhKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICBpZiAocGFnaW5hdGlvblNlc3Npb24pXG4gICAgICAgICAgICAgICAgICAgIHBhZ2luYXRpb25TZXNzaW9uLl9uZXdQYWdlTG9hZGVkKGRhdGEpXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY2IoZXJyLCBkYXRhKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgIH1cblxufVxuXG5leHBvcnQgZGVmYXVsdCBEYXRhIiwiaW1wb3J0IFVybEJ1aWxkZXIgZnJvbSAnLi91cmxCdWlsZGVyLmpzJ1xuaW1wb3J0IFV0aWxYSFIgZnJvbSAnLi91dGlsWGhyLmpzJ1xuXG5leHBvcnQgZGVmYXVsdCB7XG5cbiAgICAvKipcbiAgICAgKiBjYiA6IGNhbGxiYWNrIGZ1bmN0aW9uXG4gICAgICovXG4gICAgbGlzdCAoY2IpIHtcblxuICAgICAgVXRpbFhIUi5nZXQoVXJsQnVpbGRlci5mb3JTY2hlbWEoKSwgY2IpXG5cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogdHlwZSA6IHN0cmluZywgdGhlIG5hbWUgb2YgdGhlIHNjaGVtYVxuICAgICAqIHNjaGVtYURlZiA6IGNvbnRlbnQgZm9yIHRoZSBuZXcgc2NoZW1hIDogX2FjbCBhbmQgb3RoZXIgZWxhc3RpYyBzZWFyY2ggYXR0cmlidXRlc1xuICAgICAqIGNiIDogY2FsbGJhY2sgZnVuY3Rpb25cbiAgICAgKi9cbiAgICBjcmVhdGUgKHR5cGUsIHNjaGVtYURlZiwgY2IpIHtcblxuICAgICAgdmFyIHBheWxvYWQgPSB7fTtcbiAgICAgIHBheWxvYWRbdHlwZV0gPSBzY2hlbWFEZWY7XG5cbiAgICAgIFV0aWxYSFIucG9zdChwYXlsb2FkLCBVcmxCdWlsZGVyLmZvck9uZVNjaGVtYSh0eXBlKSwgY2IpO1xuXG4gICAgfSxcbn0iLCJcbmV4cG9ydCBkZWZhdWx0IHtcbiAgXG4gIGFsbDogWydjcmVhdGUnLFxuICAgICAgICdyZWFkJyxcbiAgICAgICAncmVhZF9hbGwnLFxuICAgICAgICdzZWFyY2gnLFxuICAgICAgICd1cGRhdGUnLFxuICAgICAgICd1cGRhdGVfYWxsJyxcbiAgICAgICAnZGVsZXRlJyxcbiAgICAgICAnZGVsZXRlX2FsbCddLFxuXG4gIGRlZmF1bHRfYWRtaW46IFsnY3JlYXRlJywgJ3NlYXJjaCcsICd1cGRhdGVfYWxsJywgJ2RlbGV0ZV9hbGwnXSxcblxuICBkZWZhdWx0X3VzZXI6IFsnY3JlYXRlJywgJ3NlYXJjaCcsICd1cGRhdGUnLCAnZGVsZXRlJ10sXG5cbiAgZGVmYXVsdF9rZXk6IFsncmVhZF9hbGwnXSxcblxufSIsImV4cG9ydCBkZWZhdWx0IFt7XG4gICAgbmFtZTonc3RyaW5nJyxcbiAgfSx7XG4gICAgbmFtZTonYm9vbGVhbicsXG4gIH1dOyIsIlxuaW1wb3J0IENvbmZpZyBmcm9tICcuL2xpYi9jb25maWcuanMnXG5pbXBvcnQgQ3JlZGVudGlhbHMgZnJvbSAnLi9saWIvY3JlZGVudGlhbHMuanMnXG5pbXBvcnQgRGF0YSBmcm9tICcuL2xpYi9kYXRhLmpzJ1xuaW1wb3J0IFNjaGVtYSBmcm9tICcuL2xpYi9zY2hlbWEuanMnXG5pbXBvcnQgRGF0YVBlcm1pc3Npb24gZnJvbSAnLi9saWIvZGF0YVBlcm1pc3Npb24uanMnXG5pbXBvcnQgRGF0YVR5cGVzIGZyb20gJy4vbGliL2RhdGFUeXBlcy5qcydcblxudmFyIFNwYWNlRG9nID0ge1xuICAgIGluaXRpYWxpemUgKGJhY2tlbmRJZCkge1xuICAgICAgICBpZiAoYmFja2VuZElkID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgXCJCYWNrZW5kSWQgaXMgcmVxdWlyZWQuXCJcbiAgICAgICAgfVxuICAgICAgICBDb25maWcuYmFja2VuZElkID0gYmFja2VuZElkXG4gICAgICAgIENvbmZpZy5iYXNlVXJsID0gYGh0dHBzOi8vJHtDb25maWcuYmFja2VuZElkfS5zcGFjZWRvZy5pb2BcbiAgICB9LFxuXG4gICAgaW5pdGlhbGl6ZVdpdGhCYXNlVXJsIChiYXNlVXJsKSB7XG4gICAgICAgIGlmIChiYXNlVXJsID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgXCJCYXNlVXJsIGlzIHJlcXVpcmVkLlwiXG4gICAgICAgIH1cbiAgICAgIENvbmZpZy5iYWNrZW5kSWQgPSBudWxsXG4gICAgICBDb25maWcuYmFzZVVybCA9IGJhc2VVcmxcbiAgICB9LFxuICAgIFxuICAgIGdldEJhc2VVcmwgKCkge1xuICAgICAgICByZXR1cm4gQ29uZmlnLmJhc2VVcmxcbiAgICB9LFxuXG4gICAgZ2V0QmFja2VuZElkICgpIHtcbiAgICAgICAgcmV0dXJuIENvbmZpZy5iYWNrZW5kSWRcbiAgICB9LFxuXG4gICAgZm9yZ2V0QWxsICgpIHtcbiAgICAgICAgQ29uZmlnLmJhY2tlbmRJZCA9IG51bGxcbiAgICAgICAgQ29uZmlnLmJhc2VVcmwgPSBudWxsXG4gICAgICAgIENvbmZpZy5kZWZhdWx0X2F1dGhvcml6YXRpb25faGVhZGVyID0gbnVsbFxuICAgIH1cbn1cblxuXG5TcGFjZURvZy5fQ29uZmlnID0gQ29uZmlnIC8vIHBhcyBlbiByZWxlYXNlID9cblNwYWNlRG9nLkNyZWRlbnRpYWxzID0gQ3JlZGVudGlhbHNcblNwYWNlRG9nLkRhdGEgPSBEYXRhXG5TcGFjZURvZy5TY2hlbWEgPSBTY2hlbWFcblNwYWNlRG9nLkRhdGFQZXJtaXNzaW9uID0gRGF0YVBlcm1pc3Npb25cblNwYWNlRG9nLkRhdGFUeXBlcyA9IERhdGFUeXBlc1xuXG5leHBvcnQgZGVmYXVsdCBTcGFjZURvZ1xuIl0sIm5hbWVzIjpbInFzIiwicmVxdWlyZSIsIkNvbmZpZyIsImJhc2VVcmwiLCJ0eXBlIiwiaWQiLCJjcmVkZW50aWFsX2lkIiwicGFzc3dvcmRfcmVzZXRfY29kZSIsIm9wdHMiLCJ1cmwiLCJzdHJpbmdpZnkiLCJfeGVuZCIsIm1ldGhvZCIsInBheWxvYWQiLCJjYiIsImRhdGEiLCJ1bmRlZmluZWQiLCJKU09OIiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwianNvbiIsInBhcnNlIiwicmVzcG9uc2VUZXh0Iiwic3VjY2VzcyIsInN0YXR1cyIsImUiLCJ3YXJuIiwib3BlbiIsInNldFJlcXVlc3RIZWFkZXIiLCJhdXRob3JpemF0aW9uIiwiZGVmYXVsdF9hdXRob3JpemF0aW9uX2hlYWRlciIsInNlbmQiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwicG9zdCIsImNyZWRlbnRpYWxzIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsImVtYWlsIiwiVXJsQnVpbGRlciIsImZvckNyZWRlbnRpYWxzIiwiZXJyIiwidXNlclBheWxvYWQiLCJ1c2VyIiwiY3JlZGVudGlhbElkRmllbGQiLCJmb3JEYXRhIiwibWV0YSIsInJlbW92ZUl0ZW0iLCJmb3JDcmVkZW50aWFsRm9yZ290UGFzc3dvcmQiLCJnZXQiLCJmb3JDcmVkZW50aWFsRGF0YSIsImNyZWRlbnRpYWxJZCIsImVuYWJsZWQiLCJCdWZmZXIiLCJ0b1N0cmluZyIsImJ0b2EiLCJmb3JMb2dpbiIsImFjY2Vzc1Rva2VuIiwicmVtZW1iZXJNZSIsInNldEl0ZW0iLCJiYWNrZW5kSWQiLCJzYXZlZCIsImZvckNyZWRlbnRpYWxSZXNldFBhc3N3b3JkIiwicGFzc3dvcmRSZXNldENvZGUiLCJwdXQiLCJzdGF0ZSIsImZvckNyZWRlbnRpYWxFbmFibGVkIiwibmV3UGFzc3dvcmQiLCJmb3JDcmVkZW50aWFsUGFzc3dvcmQiLCJjaGFsbGVuZ2VkVXNlcm5hbWUiLCJjaGFsbGVuZ2VkUGFzc3dvcmQiLCJQYWdpbmF0aW9uU2Vzc2lvbiIsImZyb20iLCJzaXplIiwiX2Zyb20iLCJfc2l6ZSIsIl90b3RhbCIsInJlc3VsdCIsInRvdGFsIiwiT2JqZWN0IiwiX3R5cGUiLCJfaWQiLCJfcGF5bG9hZCIsInJldCIsImZvckRhdGFPYmplY3QiLCJkZWxldGUiLCJEYXRhIiwicGFnaW5hdGlvblNlc3Npb24iLCJnZXRGcm9tIiwiZ2V0U2l6ZSIsImZvclNlYXJjaCIsIl9uZXdQYWdlTG9hZGVkIiwiZm9yU2NoZW1hIiwic2NoZW1hRGVmIiwiZm9yT25lU2NoZW1hIiwiU3BhY2VEb2ciLCJfQ29uZmlnIiwiQ3JlZGVudGlhbHMiLCJTY2hlbWEiLCJEYXRhUGVybWlzc2lvbiIsIkRhdGFUeXBlcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsYUFBZTs7ZUFFRCxJQUZDOztrQ0FJa0I7O0NBSmpDOztBQ0VBLElBQUlBLEtBQUtDLFFBQVEsSUFBUixDQUFUOztBQUVBLGlCQUFlO1lBQUEsc0JBRUM7ZUFDRUMsT0FBT0MsT0FBakI7S0FITzthQUFBLHVCQU1FO2VBQ0NELE9BQU9DLE9BQWpCO0tBUE87Z0JBQUEsd0JBVUdDLElBVkgsRUFVUztlQUNORixPQUFPQyxPQUFqQixrQkFBcUNDLElBQXJDO0tBWE87YUFBQSxxQkFjQUEsSUFkQSxFQWNNO2VBQ0hGLE9BQU9DLE9BQWpCLGtCQUFxQ0MsSUFBckM7S0FmTztrQkFBQSw0QkFrQk87ZUFDSkYsT0FBT0MsT0FBakI7S0FuQk87eUJBQUEsaUNBc0JZRSxFQXRCWixFQXNCZ0I7ZUFDYkgsT0FBT0MsT0FBakIsdUJBQTBDRSxFQUExQztLQXZCTzsrQkFBQSx5Q0EwQm9CO2VBQ2pCSCxPQUFPQyxPQUFqQjtLQTNCTzs4QkFBQSxzQ0E4QmlCRyxhQTlCakIsRUE4QmdDQyxtQkE5QmhDLEVBOEJxRDtlQUNsREwsT0FBT0MsT0FBakIsdUJBQTBDRyxhQUExQyxvQ0FBc0ZDLG1CQUF0RjtLQS9CTzt3QkFBQSxnQ0FrQ1dELGFBbENYLEVBa0MwQjtlQUN2QkosT0FBT0MsT0FBakIsdUJBQTBDRyxhQUExQztLQW5DTztxQkFBQSw2QkFzQ1FBLGFBdENSLEVBc0N1QjtlQUNwQkosT0FBT0MsT0FBakIsdUJBQTBDRyxhQUExQztLQXZDTztXQUFBLG1CQTBDRkYsSUExQ0UsRUEwQ0k7ZUFDREYsT0FBT0MsT0FBakIsZ0JBQW1DQyxJQUFuQztLQTNDTztpQkFBQSx5QkE4Q0lBLElBOUNKLEVBOENVQyxFQTlDVixFQThDY0csSUE5Q2QsRUE4Q29CO1lBQ3ZC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
